<div
  class="p-4 h-100 rounded-syllex"
  [class]="isFolder ? 'folder-card' : 'materiale-card'"
  [class.selected]="isSelected"
  (dblclick)="requestOpenItem()"
  (click)="selectItem($event)"
>
  <div class="card-body">
    <div
      class="d-flex flex-row align-items-start justify-content-between gap-3"
    >
      <div
        class="d-flex flex-column h-100 justify-content-center gap-2 flex-fill overflow-hidden"
      >
        <fa-icon
          [icon]="icon"
          class="me-3"
          size="2x"
          [style.color]="iconColor"
        ></fa-icon>

        <div class="overflow-hidden">
          <p
            class="card-title mb-0 text-truncate"
            [class.highlight]="highlightedItemId === item._id"
          >
            {{ item.name }}
          </p>
        </div>
      </div>
      @if (showActions) {
      <div ngbDropdown class="d-inline-block">
        <button
          class="btn btn-light circle-btn btn-sm"
          (click)="$event.stopPropagation()"
          ngbDropdownToggle
        >
          <fa-icon [icon]="ThreeDotsIcon"></fa-icon>
        </button>
        <div ngbDropdownMenu>
          <app-materiale-contextual-menu
            #contextualMenu
            [item]="item"
            (renameItem)="renameItem.emit($event)"
            (deleteItem)="deleteItem.emit()"
          ></app-materiale-contextual-menu>
        </div>
      </div>
      }
    </div>

    <div class="d-flex flex-row align-items-center justify-content-between mt-3">
      @if (showSharing) {
      <div class="d-flex flex-row gap-2 align-items-center">
        @if(isFolder){
        <small class="text-muted"
          >{{ folderContentLength }} element{{ folderContentLength !== 1 ? 'i' :
          'o' }}</small
        >
        | }
        <a
          class="text-muted small"
          (click)="$event.stopPropagation(); requestAssignToClass()"
          ><fa-icon [icon]="ShareNodesIcon"></fa-icon>@if(item.classIds?.length
          === 0 || !item.classIds){ Non condiviso } @else { {{
          item.classIds?.length }} class{{ item.classIds?.length !== 1 ? 'i' : 'e'
          }} }</a
        >
      </div>
      } @else {
      <span></span>
      }

      @if (isAIGenerated) {
      <span class="badge" style="background-color: #9664c8; font-size: 0.65rem;">IA</span>
      }
    </div>
  </div>
</div>
