<div class="card p-3">
  <div class="card-body">
    <div class="d-flex flex-row text-dark align-items-center mb-3">
      <h6 class="mb-0 flex-fill">{{ comunicazione.title }}</h6>
      @if (!readonly()) {
      <div class="d-flex flex-row gap-1 justify-content-end align-items-center">
        <button
          type="button"
          class="btn btn-outline-primary"
          title="Modifica"
          [routerLink]="'/t/comunicazioni/edit/' + comunicazione._id"
        >
          <fa-icon [icon]="EditIcon"></fa-icon>
        </button>
        <button
          type="button"
          class="btn btn-outline-danger"
          title="Rimuovi"
          confirmAction
          [confirmMessage]="'Sei sicuro di voler eliminare la comunicazione dal titolo &quot;' + comunicazione.title + '&quot;?'"
          confirmTitle="Conferma eliminazione"
          (confirmed)="onDelete()"
        >
          <fa-icon [icon]="TrashIcon"></fa-icon>
        </button>
      </div>
      }
    </div>
    <small class="fw-light ellipsis-1-lines">
      {{ comunicazione.content }}
    </small>

    <div class="d-flex flex-row justify-content-between align-items-end mt-4">
      <section class="flex-fill">
        @if(attachments && attachments.length > 0) {
        <small>{{ attachments.length }} Allegati: </small>
        <div class="d-flex flex-row mt-2">
          @for(att of attachments; track $index){
          <span
            class="badge p-2 attachment-badge"
            (dblclick)="onRequestAttachmentView(att)"
          >
            <fa-icon [icon]="getFileIcon(att.extension!)"></fa-icon>
            {{ att.name }}</span
          >
          }
        </div>
        }
      </section>

      <span class="small"
        >Ultima modifica: {{ comunicazione.createdAt | date:'short' }}</span
      >
    </div>
  </div>
</div>
