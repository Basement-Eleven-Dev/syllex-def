<form [formGroup]="filtersForm" class="d-flex flex-row gap-3 mb-4">
  <input
    type="text"
    class="form-control custom-input filter"
    style="max-width: 300px"
    placeholder="Cerca per nome o cognome..."
    formControlName="text"
    (input)="applyFilters()"
  />
</form>

<div class="card p-3">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-hover align-middle table-striped">
        <thead>
          <tr>
            <th></th>
            <th class="text-muted fw-light">Nome</th>
            <th class="text-muted fw-light">Cognome</th>
            <th class="text-muted fw-light">Punteggio</th>
            <th class="text-muted fw-light">Consegnato il</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          @for(assignment of filteredAssignments(); track assignment._id) {
          <tr>
            <td>
              <div class="avatar avatar-sm">
                <img
                  src="https://api.dicebear.com/9.x/initials/svg?seed={{ assignment.studentName }} {{ assignment.studentLastName }}"
                  alt="avatar"
                  height="30"
                  class="rounded-circle"
                />
              </div>
            </td>
            <td>{{ assignment.studentName }}</td>
            <td>{{ assignment.studentLastName }}</td>
            <td>
              {{ assignment.score !== undefined ? (assignment.score + ' / ' +
              (assignment.maxScore || '100')) : '/' }}
            </td>
            <td>
              {{ (assignment.deliveredAt | date: 'dd MMMM HH:mm' | titlecase) ||
              '/' }}
            </td>
            <td class="text-end">
              <button
                class="btn icon-btn"
                [routerLink]="'/t/correzione/' + assignment._id"
                [class.btn-warning]="assignment.status !== 'reviewed'"
                [class.btn-primary]="assignment.status === 'reviewed'"
              >
                {{ assignment.status !== 'reviewed' ? 'Correggi' : 'Visualizza'
                }}
              </button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>

    <div
      class="mt-5 d-flex flex-row justify-content-between align-items-center"
    >
      <app-syllex-pagination
        [collectionSize]="collectionSize"
        [page]="page"
        [pageSize]="pageSize"
        (pageChange)="page = $event; onNewPageRequested()"
      />
    </div>
  </div>
</div>
