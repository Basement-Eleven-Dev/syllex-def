<div
  [class]="isOffcanvasMode() ? 'offcanvas-body dvh-100 overflow-scroll p-4' : 'pb-5'"
>
  <form
    [formGroup]="genForm"
    (ngSubmit)="onSubmit()"
    class="d-flex flex-column gap-4"
  >
    <section class="form-section">
      <label class="form-label text-dark mb-3"
        >Che tipo di {{ typeSignal() == 'questions' ? 'domande' : 'materiale' }}
        vuoi creare?</label
      >
      <app-type-selector
        [options]="types()"
        [(selectedValue)]="selectedType"
        [direction]="'row'"
        [showDescription]="true"
      ></app-type-selector>
    </section>
    @if(typeSignal() == 'questions') {
    <section class="form-section">
      <label class="form-label text-dark mb-3"
        >Quante domande vuoi generare?</label
      >
      <input
        type="number"
        class="form-control custom-input"
        formControlName="numberOfQuestions"
        min="1"
        max="20"
        style="max-width: 200px"
        placeholder="Inserisci il numero di domande da generare..."
      />
    </section>
    }
    <section class="form-section">
      <label class="form-label text-dark mb-3"
        >Su che argomento di {{ materiaService.materiaSelected()?.name }} vuoi
        che si concentri l'AI?</label
      >
      <select
        class="form-select custom-input w-auto"
        formControlName="topicId"
        aria-label="Seleziona argomento"
      >
        <option value="" disabled selected>Seleziona argomento</option>
        @for(topic of materiaService.materiaSelected()?.topics; track topic._id)
        {
        <option [value]="topic._id">{{ topic.name }}</option>
        }
      </select>
    </section>

    <section class="form-section">
      <label class="form-label text-dark mb-3"
        >Se vuoi puoi specificare uno o più file dalle tue risorse a supporto
        della generazione</label
      >
      <app-materiali-selector></app-materiali-selector>
    </section>
    <section class="form-section">
      <label class="form-label text-dark mb-3"
        >Aggiungi dettagli utili per indirizzare meglio la generazione</label
      >
      <textarea
        class="form-control custom-input"
        formControlName="prompt"
        rows="4"
        [placeholder]="typeSignal() == 'questions' ? 'Ad esempio: argomento specifico, difficoltà, specifiche delle domande...' : 'Ad esempio: stile, tono di voce, punti chiave da trattare...'"
      ></textarea>
    </section>

    <div class="text-end">
      <button
        type="submit"
        class="btn btn-primary ai btn-lg icon-btn"
        [disabled]="genForm.invalid"
        (click)="onSubmit()"
      >
        <fa-icon [icon]="SparklesIcon"></fa-icon>
        Genera {{ getSelectedTypeName() }}
      </button>
    </div>
  </form>
</div>
