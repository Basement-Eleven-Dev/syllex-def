<div class="d-flex flex-row align-items-center mb-5">
  <div>
    <h1 class="text-dark fw-medium mb-3 display-6">Lista dei test</h1>
    <h5 class="text-dark mb-0 fw-normal">
      Gestisci i test di valutazione da assegnare alle tue classi
    </h5>
  </div>
  <button
    class="btn btn-gradient-secondary btn-lg ms-auto py-3 icon-btn"
    routerLink="/t/tests/new"
  >
    <fa-icon [icon]="PlusIcon" />
    Nuovo test
  </button>
</div>

<section class="d-flex flex-row mb-5 gap-3">
  <div>
    <input
      type="text"
      id="search-term"
      class="form-control me-3 custom-input filter"
      placeholder="Cerca test..."
      style="min-width: 400px"
      [value]="SearchTerm()"
      (input)="onSearchTermChange($any($event.target).value)"
    />
  </div>

  <div>
    <select
      id="publication-status"
      class="form-select custom-input filter"
      style="max-width: 200px"
      [value]="Status()"
      (change)="onStatusChange($any($event.target).value)"
    >
      <option value="">Stato</option>
      @for(status of ['bozza', 'pubblicato', 'archiviato']; track $index) {
      <option [value]="status">{{ status | titlecase }}</option>
      }
    </select>
  </div>
  <button
    type="button"
    class="btn btn-outline-danger"
    (click)="clearFilters()"
    title="Pulisci filtri"
  >
    <fa-icon [icon]="ClearIcon"></fa-icon>
  </button>
  <app-view-type-toggle
    class="ms-auto"
    [viewType]="ViewType"
    [pageKey]="'test'"
    (viewTypeChange)="onChangeViewType($event)"
  />
</section>

@if(ViewType === 'table') {
<app-test-table
  [tests]="Tests()"
  (delete)="onDeleteTest($event)"
  (duplicate)="onDuplicateTest($event)"
/>
} @else {
<div class="row">
  @for(test of Tests(); track test._id) {
  <div class="col-12 col-lg-6 col-xl-4 mb-3">
    <app-test-card
      [test]="test"
      (delete)="onDeleteTest($event)"
      (duplicate)="onDuplicateTest($event)"
    />
  </div>
  } @empty {
  <div class="col-12">
    <div class="alert alert-info text-center">
      Nessun test trovato. Crea il tuo primo test!
    </div>
  </div>
  }
</div>
}

<div class="mt-5 d-flex flex-row justify-content-between align-items-center">
  <app-syllex-pagination
    [collectionSize]="CollectionSize()"
    [page]="Page()"
    [pageSize]="PageSize()"
    (pageChange)="onNewPageRequested($event)"
  />

  <select
    class="form-select form-select-sm custom-input"
    style="width: auto"
    [value]="PageSize()"
    (change)="onPageSizeChange(+$any($event.target).value)"
  >
    <option value="5">5 per pagina</option>
    <option value="10">10 per pagina</option>
    <option value="20">20 per pagina</option>
  </select>
</div>
