<div class="offcanvas-body">
  <form
    [formGroup]="genForm"
    (ngSubmit)="onSubmit()"
    class="d-flex flex-column gap-4"
  >
    <section class="form-section">
      <label class="fw-semibold fs-5 text-dark mb-3"
        >Che tipo di {{ type() == 'questions' ? 'domande' : 'materiale' }} vuoi
        creare?</label
      >
      <app-type-selector
        [options]="types()"
        [(selectedValue)]="selectedType"
        [direction]="'row'"
        [showDescription]="true"
      ></app-type-selector>
    </section>
    @if(type() == 'questions') {
    <section class="form-section">
      <label class="fw-semibold fs-5 text-dark mb-3"
        >Quante domande vuoi generare?</label
      >
      <input
        type="number"
        class="form-control custom-input"
        formControlName="numberOfQuestions"
        min="1"
        max="20"
        placeholder="Inserisci il numero di domande da generare..."
      />
    </section>
    }
    <section class="form-section">
      <label class="fw-semibold fs-5 text-dark mb-3"
        >Su che argomento/i di {{ materiaService.materiaSelected()?.name }} vuoi
        che si concentri l'AI?</label
      >
      <div class="d-flex flex-row align-items-center gap-3">
        @for(t of materiaService.materiaSelected()?.topics; track $index) {
        <button
          class="btn rounded-pill h3 topicBtn"
          [class.selected]="isTopicSelected(t._id)"
          (click)="onToggleTopic(t._id)"
        >
          {{t.name}}
        </button>
        }
      </div>
    </section>

    <section class="form-section">
      <label class="fw-semibold fs-5 text-dark mb-3"
        >Se vuoi puoi specificare uno o più file dalle tue risorse a supporto
        della generazione</label
      >
      <app-materiali-selector></app-materiali-selector>
    </section>
    <section class="form-section">
      <label class="fw-semibold fs-5 text-dark mb-3"
        >Aggiungi dettagli utili per indirizzare meglio la generazione</label
      >
      <textarea
        class="form-control custom-input"
        formControlName="prompt"
        rows="4"
        [placeholder]="type() == 'questions' ? 'Ad esempio: argomento specifico, difficoltà, specifiche delle domande...' : 'Ad esempio: stile, tono di voce, punti chiave da trattare...'"
      ></textarea>
    </section>
    <div class="text-end">
      <button
        type="submit"
        class="btn btn-lg fs-3 ai"
        [disabled]="genForm.invalid"
      >
        <fa-icon [icon]="SparklesIcon" class="me-2"></fa-icon>
        Genera {{ getSelectedTypeName() }}
      </button>
    </div>
  </form>
</div>
