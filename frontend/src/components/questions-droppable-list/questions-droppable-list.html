<div class="droppable-container">
  <div class="d-flex justify-content-between align-items-center">
    <label class="form-label fw-semibold text-dark">Domande del Test</label>
    @if (selectedQuestions.length > 0) {
    <a class="text-danger" (click)="clearAll()"> Rimuovi tutte </a>
    }
  </div>

  <!-- Statistiche Test -->
  @if (selectedQuestions.length > 0) {
  <div class="test-stats card mb-3 p-3 bg-light">
    <div class="row">
      <div class="col-md-3">
        <div class="stat-item">
          <strong class="h5 mb-0">{{ selectedQuestions.length }}</strong>
          <small class="text-muted d-block">Domande</small>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stat-item">
          <strong class="h5 mb-0">{{ getTotalPoints() }}</strong>
          <small class="text-muted d-block">Punti Totali</small>
        </div>
      </div>
      <div class="col-md-6 d-flex justify-content-center align-items-center">
        <div class="stat-item">
          <div
            class="h5 mb-0 d-flex align-items-center justify-content-center gap-2"
          >
            <span class="badge bg-primary"
              >SM: {{ getQuestionsByType('scelta multipla') }}</span
            >
            <span class="badge bg-info"
              >VF: {{ getQuestionsByType('vero falso') }}</span
            >
            <span class="badge bg-success"
              >RA: {{ getQuestionsByType('risposta aperta') }}</span
            >
          </div>
          <small class="text-muted d-block text-center">Distribuzione</small>
        </div>
      </div>
    </div>
  </div>
  }

  <!-- Drop Zone -->
  <section
    class="drop-zone p-4 rounded-5"
    [class.has-items]="selectedQuestions.length > 0"
    [class.empty]="selectedQuestions.length === 0"
    cdkDropList
    id="test-drop-list"
    cdkDropListSortingEnabled
    [cdkDropListData]="selectedQuestions"
    (cdkDropListDropped)="onDrop($event)"
  >
    @if (selectedQuestions.length === 0) {
    <div class="empty-state text-center py-5">
      <i class="bi bi-file-earmark-plus display-1 text-muted mb-3"></i>
      <p class="text-muted mb-0">
        Trascina qui le domande per aggiungerle al test
      </p>
    </div>
    } @else {
    <div class="selected-questions-list">
      @for (question of selectedQuestions; track question.id; let last = $last;
      let index = $index) {
      <div
        app-question-card
        cdkDrag
        [question]="question"
        [index]="index"
        [showTestCompositionActions]="true"
        [showIndex]="true"
        [class.mb-3]="!last"
        (removeMe)="removeQuestion($event)"
      ></div>
      }
    </div>
    }
  </section>
</div>
