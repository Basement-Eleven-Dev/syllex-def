<div class="d-flex flex-row align-items-center mb-5">
  <div>
    <h1
      class="text-dark fw-bold mb-0 display-6 align-items-center d-flex gap-3"
    >
      Comunicazioni
    </h1>
    <p class="text-dark mb-0">
      Comunica con le tue classi inviando loro comunicazioni importanti e
      aggiornamenti.
    </p>
  </div>
  <button
    class="btn btn-primary btn-lg ms-auto py-3"
    routerLink="/t/comunicazioni/new"
  >
    <fa-icon [icon]="PlusIcon"></fa-icon>
    Nuova comunicazione
  </button>
</div>

<section class="form-section d-flex flex-row align-items-center mb-5 gap-3">
  <div>
    <label for="search-term" class="form-label fw-semibold text-dark"
      >Contenuto della comunicazione</label
    >
    <input
      type="text"
      class="form-control me-3 custom-input"
      id="search-term"
      placeholder="Cerca comunicazione tramite parole chiave..."
      style="min-width: 400px"
      [ngModel]="searchTerm()"
      (ngModelChange)="onSearchTermChange($event)"
    />
  </div>

  <div>
    <label for="class" class="form-label fw-semibold text-dark">Classe</label>
    <select
      class="form-select custom-input"
      style="max-width: 200px"
      id="class"
      [ngModel]="selectedClassId()"
      (ngModelChange)="onClassFilterChange($event)"
    >
      <option value="">Tutte</option>
      @for(classe of classiService.classi(); track classe._id) {
      <option [value]="classe._id">{{ classe.name }}</option>
      }
    </select>
  </div>
  <div>
    <label for="attachments" class="form-label fw-semibold text-dark"
      >Allegati</label
    >
    <select
      class="form-select custom-input"
      style="max-width: 200px"
      id="attachments"
      [ngModel]="selectedHasAttachments()"
      (ngModelChange)="onAttachmentsFilterChange($event)"
    >
      <option value="">Tutti</option>
      <option value="true">Si</option>
      <option value="false">No</option>
    </select>
  </div>
</section>

@for(comunicazione of comunicazioni(); track comunicazione._id){
<div
  class="mb-3"
  app-comunicazione-card
  [comunicazione]="comunicazione"
  (deleted)="onComunicazioneDeleted($event)"
></div>
}

<div class="mt-5 d-flex flex-row justify-content-between align-items-center">
  <ngb-pagination
    [collectionSize]="collectionSize()"
    [page]="page()"
    [pageSize]="pageSize()"
    (pageChange)="page.set($event)"
  >
  </ngb-pagination>

  <select
    class="form-select form-select-sm"
    style="width: auto"
    [ngModel]="pageSize()"
    (ngModelChange)="pageSize.set($event); page.set(1)"
  >
    <option [ngValue]="5">5 per pagina</option>
    <option [ngValue]="10">10 per pagina</option>
    <option [ngValue]="20">20 per pagina</option>
  </select>
</div>
