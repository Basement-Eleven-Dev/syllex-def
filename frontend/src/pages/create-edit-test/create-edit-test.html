<h1 class="text-dark fw-bold mb-0 display-6">Nuovo Test di valutazione</h1>
<p class="text-dark mb-5">Prepara il prossimo test per le tue classi</p>

<form [formGroup]="testForm" class="d-flex flex-column gap-5">
  <section class="d-flex flex-column gap-4 p-4 form-section">
    <h4 class="text-dark fw-semibold mb-3">Informazioni Generali</h4>
    <div class="row">
      <div class="col-6">
        <label for="test-title" class="form-label fw-semibold text-dark"
          >Titolo del test</label
        >
        <input
          type="text"
          id="test-title"
          class="form-control custom-input form-control-lg"
          formControlName="title"
          placeholder="Inserisci il titolo del test"
        />
      </div>
    </div>
    <div class="row">
      <div class="col-6">
        <div class="row">
          <div class="col-6">
            <label for="available-from" class="form-label fw-semibold text-dark"
              >Disponibile da</label
            >
            <input
              type="date"
              formControlName="availableFrom"
              id="available-from"
              class="form-control custom-input"
            />
          </div>
          <div class="col-6">
            <label for="available-to" class="form-label fw-semibold text-dark"
              >Disponibile fino a</label
            >
            <input
              type="date"
              formControlName="availableTo"
              id="available-to"
              class="form-control custom-input"
            />
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-4">
        <label for="classes-assigned" class="form-label fw-semibold text-dark"
          >Classi assegnate</label
        >
        <div class="d-flex flex-row gap-2 flex-wrap" id="classes-assigned">
          @for(class of availableClasses; track $index) {
          <span
            class="badge fs-5 px-3 classBadge"
            (click)="onToggleAssignedClass(class.id)"
            [class.selected]="isClassSelected(class.id)"
            >{{ class.name }}</span
          >
          }
        </div>
      </div>
      <div class="col-4">
        <label for="access-password" class="form-label fw-semibold text-dark"
          >Password d'accesso</label
        >
        <div class="d-flex flex-row gap-3">
          <input
            type="text"
            id="access-password"
            class="form-control custom-input"
            formControlName="password"
            placeholder="Imposta una password per il test (opzionale)"
          />
          <button class="btn btn-primary" (click)="onGeneratePassword()">
            <fa-icon [icon]="GenPasswordIcon"></fa-icon>
          </button>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-4">
        <label for="required-score" class="form-label fw-semibold text-dark"
          >Punteggio minimo per idoneit√†</label
        >
        <input
          type="number"
          min="0"
          max="100"
          id="required-score"
          class="form-control custom-input"
          formControlName="requiredScore"
          placeholder="Imposta il punteggio minimo per superare il test"
        />
      </div>
      <div class="col-4">
        <label for="max-time" class="form-label fw-semibold text-dark"
          >Tempo massimo (minuti)</label
        >
        <div class="d-flex flex-row gap-3">
          <input
            type="number"
            min="0"
            max="100"
            id="max-time"
            class="form-control custom-input"
            formControlName="time"
            [placeholder]="time === null ? 'Tempo illimitato' : 'Imposta il tempo massimo per il test'"
          />
          <button
            class="btn text-dark"
            id="infiniteButton"
            [class.selected]="time === null"
            (click)="onToggleUnlimitedTime()"
          >
            <fa-icon [icon]="InfinityIcon"></fa-icon>
          </button>
        </div>
      </div>
    </div>
  </section>
</form>

<section class="form-section p-4 mt-5">
  <h4 class="text-dark fw-bold mb-0">Domande</h4>
  <p class="text-dark">
    Cerca nella tua banca domande di Scienze natuiche e sceglile per comporre il
    test
  </p>

  <div class="row">
    <div class="col-6">
      <app-questions-filters></app-questions-filters>
    </div>
    <div class="col-6">
      <app-questions-droppable-list></app-questions-droppable-list>
    </div>
  </div>
</section>

<div class="d-flex flex-row justify-content-end mt-5 gap-3">
  <button class="btn btn-light btn-lg fs-3" (click)="onSaveTest(true)">
    <fa-icon [icon]="DraftIcon"></fa-icon>
    Salva Bozza
  </button>
  <button class="btn btn-success text-white btn-lg fs-3" (click)="onSaveTest()">
    <fa-icon [icon]="SaveIcon"></fa-icon> Salva
  </button>
</div>
